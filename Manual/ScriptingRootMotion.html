<!DOCTYPE html><html lang="en" class="no-js">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unity - Manual: Tutorial: Scripting Root Motion for &quot;in-place&quot; humanoid animations</title>
<meta name="description" content="Develop once, publish everywhere! Unity is the ultimate tool for video game development, architectural visualizations, and interactive media installations - publish to the web, Windows, OS X, Wii, Xbox 360, and iPhone with many more platforms to come.">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="../StaticFilesManual/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFilesManual/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFilesManual/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFilesManual/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFilesManual/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFilesManual/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFilesManual/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFilesManual/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFilesManual/images/favicons/tileicon-144x144.png">
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-2854981-1']);
  _gaq.push(['_setDomainName', 'unity3d.com']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  </script><script type="text/javascript" src="../StaticFilesManual/js/jquery.js"></script><script type="text/javascript" src="../StaticFilesManual/js/core.js"></script><script type="text/javascript" src="../StaticFilesManual/js/highlight.js"></script><script type="text/javascript" src="docdata/toc.js"></script><script type="text/javascript" src="docdata/global_toc.js"></script><script>hljs.initHighlightingOnLoad();</script><link href="http://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="../StaticFilesManual/css/core.css">
</head>
<body>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div class="logo"><a href="http://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul>
<li><a href="http://docs.unity3d.com">Overview</a></li>
<li><a href="../Manual/index.html" class="selected">Manual</a></li>
<li><a href="../ScriptReference/index.html">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="http://unity3d.com/">unity3d.com</a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content"><div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">Language: <span class="b">English</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/ScriptingRootMotion.html">English</a></li>
<li><a href="/es/current/Manual/ScriptingRootMotion.html">Español</a></li>
<li><a href="/ru/current/Manual/ScriptingRootMotion.html">Русский</a></li>
</ul></div>
</div></div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc"><h2>Unity Manual</h2></div></div></div></div></div>
<div id="content-wrap" class="content-wrap"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManualRestructured.html">Unity Manual</a></li>
<li><a href="AnimationSection.html">Animation</a></li>
<li><a href="AnimationOverview.html">Unity's Animation System</a></li>
<li><a href="AnimatorControllers.html">Animator Controllers</a></li>
<li><a href="AnimationStateMachines.html">Animation State Machines</a></li>
<li><a href="RootMotion.html">Root Motion - how it works</a></li>
<li>Tutorial: Scripting Root Motion for &quot;in-place&quot; humanoid animations</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="RootMotion.html"></a></span><div class="tip">Root Motion - how it works</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="class-BlendTree.html"></a></span><div class="tip">Blend Trees</div>
</div>
</div></div>
<h1>Tutorial: Scripting Root Motion for “in-place” humanoid animations</h1>
  		        <div class="suggest">
                <a class="blue-btn sbtn">Suggest a change</a>
                <div class="suggest-wrap rel hide">
                  <div class="loading hide">
<div></div>
<div></div>
<div></div>
</div>
                  <div class="suggest-success hide">
                    <h2>Success!</h2>
                    <p>Thank you for helping us improve the quality of Unity Documentation. Although we cannot accept all submissions, we do read each suggested change from our users and will make updates where applicable.</p>
                    <a class="gray-btn sbtn close">Close</a>
                  </div>
                  <div class="suggest-failed hide">
                    <h2>Sumbission failed</h2>
                    <p>For some reason your suggested change could not be submitted. Please <a>try again</a> in a few minutes. And thank you for taking the time to help us improve the quality of Unity Documentation.</p>
                    <a class="gray-btn sbtn close">Close</a>
                  </div>
                  <div class="suggest-form clear">
                    <label for="suggest_name">Your name</label>
                    <input id="suggest_name" type="text">
                    <label for="suggest_email">Your email</label>
                    <input id="suggest_email" type="email">
                    <label for="suggest_body" class="clear">Suggestion <span class="r">*</span></label>
                    <textarea id="suggest_body" class="req"></textarea>
                    <button id="suggest_submit" class="blue-btn mr10">Submit suggestion</button>
                    <p class="mb0"><a class="cancel left lh42 cn">Cancel</a></p>
                  </div>
                </div>
              </div>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>Sometimes your animation comes as “in-place”, which means if you put it in a scene, it will not move the character that it’s on. In other words, the animation does not contain “root motion”. For this, we can modify root motion from script. To put everything together follow the steps below (note there are many variations of achieving the same result, this is just one recipe). </p>

<ul>
<li>Open the inspector for the FBX file that contains the in-place animation, and go to the <span class="doc-inspector">Animation</span> tab</li>
<li>Make sure the <span class="doc-menu">Muscle Definition</span> is set to the Avatar you intend to control (let’s say this avatar is called <em>Dude</em>, and he has already been added to the <span class="doc-inspector">Hierarchy View</span>).</li>
<li>Select the animation clip from the available clips</li>
<li>Make sure <span class="doc-prop">Loop Pose</span> is properly aligned (the light next to it is green), and that the checkbox for <span class="doc-prop">Loop Pose</span> is clicked</li>
</ul>

<figure>
<img src="../uploads/Main/MecanimRootMotionChristmasTree.png" alt="">
<figcaption></figcaption></figure>

<ul>
<li>Preview the animation in the animation viewer to make sure the beginning and the end of the animation align smoothly, and that the character is moving “in-place”</li>
<li>On the animation clip <a href="AnimatorCurves">create a curve</a> that will control the speed of the character (you can add a curve from the <span class="doc-inspector">Animation Import inspector</span> <span class="doc-menu">Curves-&gt; +</span>)</li>
<li>Name that curve something meaningful, like “Runspeed”</li>
</ul>

<figure>
<img src="../uploads/Main/MecanimRootMotionCurve.png" alt="">
<figcaption></figcaption></figure>

<ul>
<li>Create a new <span class="doc-prop">Animator Controller</span>, (let’s call it <span class="doc-prop">RootMotionController</span>)</li>
<li>Drop the desired animation clip into it, this should create a state with the name of the animation (say <span class="doc-prop">Run</span>)</li>
<li>Add a parameter to the Controller with the same name as the curve (in this case, “Runspeed”)</li>
</ul>

<figure>
<img src="../uploads/Main/MecanimRootMotionController.png" alt="">
<figcaption></figcaption></figure>

<ul>
<li>Select the character <span class="doc-prop">Dude</span> in the <span class="doc-inspector">Hierarchy</span>, whose inspector should already have an <span class="doc-prop">Animator</span> component.</li>
<li>Drag <span class="doc-prop">RootMotionController</span> onto the <span class="doc-prop">Controller</span> property of the Animator</li>
<li>If you press play now, you should see the “Dude” running in place</li>
</ul>

<p>Finally, to control the motion, we will need to create a script (RootMotionScript.cs), that implements the <a href="../ScriptReference/MonoBehaviour.OnAnimatorMove.html">OnAnimatorMove</a> callback:-</p>

<pre><code>using UnityEngine;
using System.Collections;

[RequireComponent(typeof(Animator))]
    
public class RootMotionScript : MonoBehaviour {
            
    void OnAnimatorMove()
    {
            Animator animator = GetComponent&lt;Animator&gt;(); 
                              
            if (animator)
            {
     Vector3 newPosition = transform.position;
               newPosition.z += animator.GetFloat(&quot;Runspeed&quot;) * Time.deltaTime; 
     transform.position = newPosition;
            }
    }
}


</code></pre>

<p>You should attach RootMotionScript.cs to the “Dude” object. When you do this, the Animator component will detect that the script has an <a href="../ScriptReference/MonoBehaviour.OnAnimatorMove.html">OnAnimatorMove</a> function and show the <span class="doc-prop">Apply Root Motion</span> property as <em>Handled by Script</em>
</p>

<figure>
<img src="../uploads/Main/MecanimRootMotionDude.png" alt="">
<figcaption></figcaption></figure>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="RootMotion.html"></a></span><div class="tip">Root Motion - how it works</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="class-BlendTree.html"></a></span><div class="tip">Blend Trees</div>
</div>
</div>
</div>
<div class="footer-wrapper"><div class="footer clear">
<div class="copy">Copyright © 2014 Unity Technologies</div>
<div class="menu">
<a href="http://unity3d.com/learn">Learn</a><a href="http://unity3d.com/community">Community</a><a href="http://unity3d.com/asset-store">Asset Store</a><a href="https://store.unity3d.com">Buy</a><a href="http://unity3d.com/unity/download">Download</a>
</div>
</div></div>
</div></div></div>
</div>
</body>
</html>
